# 卡牌对战游戏自动战斗脚本

## 功能特点

- 自动识别游戏界面元素
- 自动检测战斗状态
- 自动执行战斗操作
- 支持卡牌选择和放置
- 支持升级人口功能
- 支持刷新卡牌功能
- 支持同名卡牌升星功能
- 智能战斗策略

## 使用方法

### 1. 创建模板

首次使用前，需要创建游戏界面元素的模板图像：

```
python create_card_battle_templates.py
```

按照向导提示，为以下界面元素创建模板：
- 战斗按钮
- 确认战斗按钮
- 胜利/失败画面
- 确认按钮
- 卡牌槽位(1-4)
- 能量指示器
- 敌方/我方塔
- 升级人口按钮
- 刷新卡牌按钮
- 同名卡牌

### 2. 运行自动战斗

创建完模板后，运行自动战斗脚本：

```
python run_card_battle_bot.py
```

选择「开始自动战斗」，输入想要进行的战斗次数，然后在5秒内切换到游戏窗口。

### 3. 测试模板识别

如果需要测试模板识别效果，可以选择「测试模板识别」，然后选择要测试的功能：

- 测试战斗状态检测
- 测试升级人口按钮识别
- 测试刷新卡牌按钮识别
- 测试同名卡牌识别

## 战斗策略

机器人会根据战场状况智能选择策略：

1. **升级人口**：在适当时机自动升级人口上限
2. **刷新卡牌**：当手牌不理想时自动刷新卡牌
3. **合并卡牌**：自动识别并合并同名卡牌以升星
4. **卡牌放置**：根据战场形势选择合适的位置放置卡牌
   - 进攻策略：优先在靠近敌方的位置放置卡牌
   - 防御策略：优先在靠近我方的位置放置卡牌

## 自定义配置

可以修改 `advanced_battle_bot.py` 中的参数来自定义战斗策略：

- `confidence`：模板匹配的置信度阈值
- `card_play_order`：卡牌打出的优先级顺序
- `aggressive_mode`：是否采用激进策略

## 注意事项

- 确保游戏窗口完全可见，不被其他窗口遮挡
- 模板创建时尽量选择特征明显的区域
- 如果识别效果不佳，可以尝试重新创建模板或调整置信度
- 使用过程中可以随时按 Ctrl+C 中断脚本运行